
# üìã –ü–æ–ª–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç: API –¥–ª—è LMS –Ω–∞ Django

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Backend**: Django 4.2 + Django REST Framework + JWT
- **Database**: PostgreSQL 15 (–≤ Docker)
- **Frontend**: –õ—é–±–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ (React, Vue, Vanilla JS)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT-—Ç–æ–∫–µ–Ω—ã (RFC 7519)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (PBKDF2), CORS, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### –î–∏–∞–≥—Ä–∞–º–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     HTTP      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ORM     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ             ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ              ‚îÇ
‚îÇ   –§—Ä–æ–Ω—Ç–µ–Ω–¥  ‚îÇ               ‚îÇ   Django    ‚îÇ            ‚îÇ PostgreSQL   ‚îÇ
‚îÇ             ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ   (Backend) ‚îÇ ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ   (Docker)   ‚îÇ
‚îÇ             ‚îÇ    JSON       ‚îÇ             ‚îÇ    SQL     ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–≤—Å–µ —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ init.sql)

| –¢–∞–±–ª–∏—Ü–∞  | –û–ø–∏—Å–∞–Ω–∏–µ                                    | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                                                  |
| --------------- | --------------------------------------------------- | --------------------------------------------------------------------------------------- |
| `users`       | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏                            | –•—Ä–∞–Ω–∏—Ç —Ö–µ—à–∏ –ø–∞—Ä–æ–ª–µ–π, –∞ –Ω–µ –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ |
| `roles`       | –†–æ–ª–∏                                            | 1=–∞–¥–º–∏–Ω, 2=–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å, 3=—Å—Ç—É–¥–µ–Ω—Ç                            |
| `users_roles` | –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π | –°–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (user_id, role_id)                       |
| `courses`     | –ö—É—Ä—Å—ã                                          | –°—Ç–∞—Ç—É—Å—ã:`is_published`, `is_deleted`                                         |
| `modules`     | –ú–æ–¥—É–ª–∏ –∫—É—Ä—Å–æ–≤                           | –°–≤—è–∑–∞–Ω—ã —Å –∫—É—Ä—Å–∞–º–∏                                                        |
| `lessons`     | –£—Ä–æ–∫–∏                                          | –ú–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã (`is_locked`)                          |
| `enrollments` | –ó–∞–ø–∏—Å–∏ –Ω–∞ –∫—É—Ä—Å—ã                        | –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞ (user_id, course_id)                                      |
| `payments`    | –ü–ª–∞—Ç–µ–∂–∏                                      | –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "completed" (–¥–µ–º–æ)                             |
| `ratings`     | –û—Ü–µ–Ω–∫–∏                                        | –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞ (user_id, course_id)                                      |

> üí° –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –ë–î ‚Äî Django **—Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** –≤ –Ω–∏—Ö —á–µ—Ä–µ–∑ ORM

---

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç**:

   ```json
   POST /api/v1/auth/register/
   {
     "email": "user@example.com",
     "first_name": "–ò–≤–∞–Ω",
     "last_name": "–ò–≤–∞–Ω–æ–≤",
     "phone": "+79991234567",
     "password": "strongpassword123",
     "password_confirm": "strongpassword123"
   }
   ```
2. **Django –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å**:

   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
   - –°–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
   - **–•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å** —Å –ø–æ–º–æ—â—å—é `make_password()` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ö–µ—à –≤ `password_hash`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–æ–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞ (3) –≤ —Ç–∞–±–ª–∏—Ü—É `users_roles`
3. **–í PostgreSQL –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã**:

   ```sql
   INSERT INTO users (email, first_name, last_name, phone, password_hash, ...)
   VALUES ('user@example.com', '–ò–≤–∞–Ω', '–ò–≤–∞–Ω–æ–≤', '+79991234567', 'pbkdf2_sha256$...', ...);

   INSERT INTO users_roles (user_id, role_id) VALUES (9, 3);
   ```

### –ü—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç**:

   ```json
   POST /api/v1/auth/login/
   {
     "email": "user@example.com",
     "password": "strongpassword123"
   }
   ```
2. **Django –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:

   - –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email
   - **–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ö–µ—à** –æ—Ç –ø—Ä–∏—Å–ª–∞–Ω–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è —Å `password_hash` –∏–∑ –ë–î
   - –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT-—Ç–æ–∫–µ–Ω—ã
3. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç**:

   ```json
   {
     "access": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
     "refresh": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
     "user_id": 9,
     "email": "user@example.com",
     "roles": [3]
   }
   ```

### –†–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏

- **Access token** (60 –º–∏–Ω—É—Ç): –¥–ª—è –≤—Å–µ—Ö –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Refresh token** (1 –¥–µ–Ω—å): –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ access token'–∞
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–µ –≤ localStorage –∏–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

## üóÇÔ∏è –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### 1. –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º)

| –≠–Ω–¥–ø–æ–∏–Ω—Ç               | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                  | –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞                                                                                                         |
| ------------------------------ | ---------- | ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `/courses/`                  | GET        | –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10) | –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–º                                                 |
| `/courses/{slug}/`           | GET        | –î–µ—Ç–∞–ª–∏ –∫—É—Ä—Å–∞                           | –ö—É—Ä—Å —Å–æ –≤—Å–µ–º–∏ –º–æ–¥—É–ª—è–º–∏ –∏ —É—Ä–æ–∫–∞–º–∏ (–±–µ–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤) |
| `/instructors/{id}/`         | GET        | –ü—Ä–æ—Ñ–∏–ª—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è         | –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è                                                                                           |
| `/instructors/{id}/courses/` | GET        | –ö—É—Ä—Å—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è             | –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è                                                       |

### 2. –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω)

| –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                         | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                                            |
| ----------------------------- | ---------- | -------------------------------------------------------- | --------------------------------------------------------------------------------- |
| `/profile/`                 | GET        | –ü—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `user_id`, –∏–º—è, email, –∞–≤–∞—Ç–∞—Ä                     |
| `/profile/enrollments/`     | GET        | –ó–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫—É—Ä—Å—ã    | –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`status='active'`)                  |
| `/courses/{slug}/learning/` | GET        | –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—É—á–µ–Ω–∏—è                        | –¢–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π               |
| `/lessons/{id}/`            | GET        | –î–µ—Ç–∞–ª–∏ —É—Ä–æ–∫–∞                                  | –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —É—Ä–æ–∫—É                         |
| `/enrollments/`             | POST       | –ó–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å                               | –°–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å + –ø–ª–∞—Ç—ë–∂ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏     |
| `/ratings/`                 | POST       | –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É                            | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å (–æ–¥–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –∫—É—Ä—Å) |

### 3. –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

| –ü—Ä–µ—Ñ–∏–∫—Å      | –û–ø–∏—Å–∞–Ω–∏–µ                                  | –î–æ—Å—Ç—É–ø           |
| ------------------- | ------------------------------------------------- | ---------------------- |
| `/admin/users/`   | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ | –¢–æ–ª—å–∫–æ role_id=1 |
| `/admin/courses/` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏               | –¢–æ–ª—å–∫–æ role_id=1 |
| `/admin/modules/` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏             | –¢–æ–ª—å–∫–æ role_id=1 |

---

## üõ†Ô∏è –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏: –∫–∞–∫ Django –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å PostgreSQL

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (–ø—Ä–∏–º–µ—Ä: –∑–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å)

**–ö–æ–¥ –≤ views.py**:

```python
@transaction.atomic
def perform_create(self, serializer):
    enrollment = serializer.save(
        user=self.request.user,  # ID –±–µ—Ä—ë—Ç—Å—è –∏–∑ JWT-—Ç–æ–∫–µ–Ω–∞
        status='active'
    )
    Payment.objects.create(
        user=self.request.user,
        course=enrollment.course,
        amount=enrollment.course.price,
        status='completed'
    )
```

**–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã**:

```sql
BEGIN;  -- –ù–∞—á–∞–ª–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

INSERT INTO enrollments (user_id, course_id, status, progress_pct, enrolled_at)
VALUES (5, 1, 'active', 0, '2025-12-19 12:00:00');

INSERT INTO payments (user_id, course_id, amount, status, paid_at)
VALUES (5, 1, 2990.00, 'completed', '2025-12-19 12:00:00');

COMMIT;  -- –§–∏–∫—Å–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```

–ï—Å–ª–∏ –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –æ—à–∏–±–∫–æ–π ‚Äî **–æ–±–∞ –æ—Ç–∫–∞—Ç—è—Ç—Å—è**.

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π (–ø—Ä–∏–º–µ—Ä: –∫—É—Ä—Å —Å –º–æ–¥—É–ª—è–º–∏)

**–ö–æ–¥ –≤ serializers.py**:

```python
def get_modules(self, obj):
    modules = obj.module_set.filter(is_deleted=False).order_by('order_num')
    return ModuleSerializer(modules, many=True, context=self.context).data
```

**–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SQL (–±–ª–∞–≥–æ–¥–∞—Ä—è prefetch_related)**:

```sql
-- –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫—É—Ä—Å–∞
SELECT * FROM courses WHERE slug = 'python';

-- –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∫—É—Ä—Å–∞
SELECT * FROM modules WHERE course_id = 1 AND is_deleted = false ORDER BY order_num;

-- –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–∫–æ–≤ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
SELECT * FROM lessons WHERE module_id IN (1, 2, 3) AND is_deleted = false ORDER BY order_num;
```

–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±—ã–ª–æ –±—ã **N+1 –∑–∞–ø—Ä–æ—Å–æ–≤** (1 –¥–ª—è –∫—É—Ä—Å–∞ + N –¥–ª—è –º–æ–¥—É–ª–µ–π + M –¥–ª—è —É—Ä–æ–∫–æ–≤).

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫

| –°—Ü–µ–Ω–∞—Ä–∏–π                                               | –û–±—Ä–∞–±–æ—Ç–∫–∞                                                                                         |
| -------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å –¥–≤–∞–∂–¥—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 400: "–í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç–æ—Ç –∫—É—Ä—Å"               |
| –û—Å—Ç–∞–≤–∏—Ç—å –≤—Ç–æ—Ä—É—é –æ—Ü–µ–Ω–∫—É –∫—É—Ä—Å—É          | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 400: "–í—ã —É–∂–µ –æ—Å—Ç–∞–≤–ª—è–ª–∏ –æ—Ç–∑—ã–≤"                         |
| –î–æ—Å—Ç—É–ø –∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —É—Ä–æ–∫—É    | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 403: "–°–Ω–∞—á–∞–ª–∞ –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É—Ä–æ–∫–∏" |
| –ù–µ–≤–µ—Ä–Ω—ã–π email/–ø–∞—Ä–æ–ª—å                            | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 401: "–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å"                        |

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

- **Email**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞
- **–ü–∞—Ä–æ–ª—å**: –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤ (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)
- **–û—Ü–µ–Ω–∫–∞**: —Ç–æ–ª—å–∫–æ –æ—Ç 1 –¥–æ 5
- **–¢–µ–ª–µ—Ñ–æ–Ω**: —Ñ–æ—Ä–º–∞—Ç –Ω–µ —Å—Ç—Ä–æ–≥–∏–π (–º–æ–∂–Ω–æ —É—Å–∏–ª–∏—Ç—å)

---

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API

### –ß–µ—Ä–µ–∑ curl (–ø—Ä–∏–º–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

```bash
curl -X POST http://127.0.0.1:8000/api/v1/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "first_name": "–¢–µ—Å—Ç",
    "last_name": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "phone": "+79991234567",
    "password": "password123",
    "password_confirm": "password123"
  }'
```

### –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–ø—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)

- `http://127.0.0.1:8000/api/v1/courses/` ‚Äî —Å–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤
- `http://127.0.0.1:8000/api/v1/courses/python/` ‚Äî –∫—É—Ä—Å Python

### –ß–µ—Ä–µ–∑ Django Admin

1. –ó–∞–π–¥–∏ –≤ `http://127.0.0.1:8000/admin/`
2. –í–æ–π–¥–∏ –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º: `nikita@edu.ru` / `123`
3. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –≤—Å–µ –¥–∞–Ω–Ω—ã–µ

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å psql –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec -it lms_db psql -U postgres -d KyrsovayaBD
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT id, email, first_name FROM users ORDER BY id DESC LIMIT 5;

-- –ó–∞–ø–∏—Å–∏ –Ω–∞ –∫—É—Ä—Å —Å ID=1
SELECT u.email, e.status, e.progress_pct 
FROM enrollments e 
JOIN users u ON e.user_id = u.id 
WHERE e.course_id = 1;

-- –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫—É—Ä—Å–∞
SELECT AVG(rating) FROM ratings WHERE course_id = 1;
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

- **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π localStorage** ‚Äî —É—è–∑–≤–∏–º –∫ XSS
- **–•—Ä–∞–Ω–∏ –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** –∏–ª–∏ –≤ HttpOnly cookie (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –±—ç–∫–µ–Ω–¥–∞)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
async function apiRequest(url, options = {}) {
  const response = await fetch(url, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      ...options.headers
    }
  });
  
  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.detail || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
  }
  
  return response.json();
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
try {
  const data = await apiRequest('/api/v1/profile/', {
    headers: { 'Authorization': `Bearer ${token}` }
  });
} catch (error) {
  if (error.message.includes('401')) {
    // –¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫ ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ª–æ–≥–∏–Ω
    redirectToLogin();
  }
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

- –ü–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ access token'–∞ (50 –º–∏–Ω—É—Ç) –≤—ã–∑—ã–≤–∞–π `/api/v1/auth/refresh/`
- –û–±–Ω–æ–≤–ª—è–π access token –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–∏–≤–∞–Ω–∏—è

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ë—ç–∫–µ–Ω–¥

```bash
cd backend
pip install -r requirements.txt
python manage.py migrate  # —Å–æ–∑–¥–∞—ë—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã Django
python manage.py runserver
```

### –§—Ä–æ–Ω—Ç–µ–Ω–¥

```bash
cd frontend
python3 -m http.server 8001  # –∏–ª–∏ —Ç–≤–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä
```

### –î–æ—Å—Ç—É–ø

- –ë—ç–∫–µ–Ω–¥ API: `http://127.0.0.1:8000/api/v1/`
- –§—Ä–æ–Ω—Ç–µ–Ω–¥: `http://127.0.0.1:8001/`

---

## üí° –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

| Email                     | –†–æ–ª—å                   | –ü–∞—Ä–æ–ª—å |
| ------------------------- | -------------------------- | ------------ |
| `nikita@edu.ru`         | –ê–¥–º–∏–Ω                 | `123`      |
| `liza@edu.ru`           | –ê–¥–º–∏–Ω                 | `123`      |
| `python_teacher@edu.ru` | –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å | `123`      |
| `student1@edu.ru`       | –°—Ç—É–¥–µ–Ω—Ç             | `123`      |

### –ö—É—Ä—Å—ã

- **Python** (`slug: python`) ‚Äî ID=1
- **Web-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** (`slug: web`) ‚Äî ID=2
- **Data Science** (`slug: data-science`) ‚Äî ID=3
- **–ú–æ–±–∏–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** (`slug: mobile`) ‚Äî ID=4
